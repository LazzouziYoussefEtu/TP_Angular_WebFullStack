<!-- <h2>Votre Panier</h2>

<div *ngIf="cartItems.length === 0">
  <p>Le panier est vide.</p>
</div> -->
<!--
<ul>
  <li *ngFor="let item of cartItems">
    <strong>{{ item.itemProduct.productTitle }}</strong>
    - Quantité: {{ item.quantity }}
    - Prix Unit: {{ item.itemProduct.productPrice }}
  </li>
</ul>

<div class="actions">
  <button (click)="buy()" class="btn-buy">Acheter maintenant</button>
  <button (click)="" class="btn-clear">Vider le panier</button>
</div> -->

<!-- <table *ngIf="cartItems.length > 0" class="cart-table">
<tr *ngFor="let item of cartItems">
  <td><img [src]="item.itemProduct.imageUrl()" alt="{{ item.itemProduct.productTitle }}" class="product-image"></td>
  <td>{{ item.itemProduct.productTitle }}</td>
  <td>Quantité: {{ item.quantity }}</td>
  <td>Prix Unit: {{ item.itemProduct.productPrice }}</td>
  <td><button (click)="removeproductfromcart(item)" class="btn-remove">Retirer</button></td>
</tr>
</table>

<div *ngIf="cartItems.length > 0" class="actions">
  <button (click)="buy()" class="btn-buy">Acheter maintenant</button>
  <button (click)="clearCart()" class="btn-clear">Vider le panier</button>
</div> -->

<div class="cart-container">
  <h2>{{ 'CART.TITLE' | translate }}</h2>

  @if (cartItems.length === 0) {
    <div class="empty-cart-message">
      <p>{{ 'CART.EMPTY_MSG' | translate }}</p>
      <a routerLink="/catalog" class="back-link">{{ 'CART.BACK_LINK' | translate }}</a>
    </div>
  }

  @if (cartItems.length > 0) {
    <div class="table-responsive">
      <table class="cart-table">
        <thead>
          <tr>
            <th>{{ 'CART.TABLE.IMAGE' | translate }}</th>
            <th>{{ 'CART.TABLE.PRODUCT' | translate }}</th>
            <th>{{ 'CART.TABLE.QUANTITY' | translate }}</th>
            <th>{{ 'CART.TABLE.UNIT_PRICE' | translate }}</th>
            <th>{{ 'CART.TABLE.ACTION' | translate }}</th>
          </tr>
        </thead>
        <tbody>
          @for (item of cartItems; track item) {
            <tr>
              <td>
                <img [src]="item.itemProduct.imageUrl()" [alt]="item.itemProduct.productTitle" class="thumb-img">
              </td>
              <td class="product-name">{{ item.itemProduct.productTitle }}</td>
              <td style="font-weight: bold;">
                <div class="qty-badges">
                  @for (i of range(item.quantity); track i) {
                    <span class="qty-dot" [style.backgroundColor]="getColor(i)" [title]="('CART.UNIT' | translate) + ' ' + (i+1)"></span>
                  }
                  <span class="qty-label">x {{ item.quantity }}</span>
                </div>
                <div class="qty-adjust">
                  <button (click)="decrementQuantity(item)" class="qty-btn">−</button>
                  <span class="qty-display">{{ item.quantity }}</span>
                  <button (click)="incrementQuantity(item)" class="qty-btn">+</button>
                </div>
              </td>
              <td class="product-price">{{ item.itemProduct.productPrice }}</td>
              <td>
                <button (click)="removeproductfromcart(item)" class="delete-btn">
                  {{ 'CART.REMOVE_BTN' | translate }}
                </button>
              </td>
            </tr>
          }
        </tbody>
      </table>
      <div class="cart-actions">
        @if (cartItems.length > 1) {
          <div>
            <button (click)="clearCart()" class="clear-btn">{{ 'CART.CLEAR_BTN' | translate }}</button></div>
          }
          <button (click)="buy()" class="buy-btn">{{ 'CART.CONFIRM_BTN' | translate }}</button>
        </div>
      </div>
    }
  </div>